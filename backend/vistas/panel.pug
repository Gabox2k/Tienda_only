extends layout

block content
  header.header
    h2 Panel de Administración
    p Bienvenido #{usuario.nombre}

  .container
    .grid
      // PRODUCTOS
      .card
        h3 Productos
        table
          thead
            tr
              th Nombre
              th Precio
              th Acciones
          tbody
            each p in productos
              tr
                td #{p.nombre}
                td $#{p.precio}
                td
                  a.btn(href=`/productos/editar/${p._id}`) ✏️
                  a.delete(href=`/productos/delete/${p._id}`) ❌

      // ÓRDENES PENDIENTES
      .card
        h3 Órdenes Pendientes
        - const pendientes = ordenes.filter(o => o.estado !== 'entregada')
        if pendientes.length === 0
          p No hay órdenes pendientes
        else
          each o in pendientes
            .orden
              p Dirección: #{o.addres}
              p Fecha: #{o.creacion.toLocaleDateString()}
              ul
                each prod in o.productos
                  li #{prod.nombre} x #{prod.cantidad}
              form(method="POST", action=`/ordenes/${o._id}/entregada`)
                button(type="submit") Marcar entregada

      // PEDIDOS ENTREGADOS
      .card
        h3 Pedidos Entregados
        - const entregadas = ordenes.filter(o => o.estado === 'entregada')
        if entregadas.length === 0
          p No hay pedidos entregados
        else
          each o in entregadas
            .orden(style="border-left-color:#16a34a")
              p Dirección: #{o.addres}
              p Fecha: #{o.creacion.toLocaleDateString()}
              ul
                each prod in o.productos
                  li #{prod.nombre} x #{prod.cantidad}
              strong Estado: Entregada
